import { useState } from 'react';
import reactLogo from './assets/react.svg';
import cloudinary from 'cloudinary-react';
import './App.css';

const ImageUploader = () => {
  const [file, setFile] = useState(null);
  const [uploadSuccess, setUploadSuccess] = useState(false);

  const handleUploadImage = async () => {
    if (!file) {
      return;
    }

    try {
      const response = await cloudinary.uploader.upload(file);
      if (response.success) {
        setUploadSuccess(true);
      }
    } catch (error) {
      console.log(error);
    }
  };

  return (
    <div>
      <input type="file" onChange={(e) => setFile(e.target.files[0])} />
      <button onClick={handleUploadImage}>Upload Image</button>
      {uploadSuccess && <p>Image uploaded successfully!</p>}
    </div>
  );
};

const ImageDeleter = ({ publicId }) => {
  const [isDeleted, setIsDeleted] = useState(false);

  const handleDeleteImage = async () => {
    try {
      const response = await cloudinary.uploader.destroy(publicId);
      if (response.success) {
        setIsDeleted(true);
      }
    } catch (error) {
      console.log(error);
    }
  };

  return (
    <div>
      <img src={cloudinary.url(publicId)} />
      <button onClick={handleDeleteImage}>Delete Image</button>
      {isDeleted && <p>Image deleted successfully!</p>}
    </div>
  );
};

function App() {

  return (
    <>
    <ImageUploader />
      <ImageDeleter />
    </>
  );
}

export default App;
